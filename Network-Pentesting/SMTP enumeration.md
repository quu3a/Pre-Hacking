*SMTP enumeration


- Basically SMTP is used to send the mails

- Mail systems commonly use SMTP with POP3 and IMAP that enables users to save the messages in the server mailbox and download them occasionally from the server. SMTP uses mail exchange servers to direct the mail via DNS. It runs on TCP port 25. 

# Follow the below steps for performing SMTP enumeration: 

- First, use telnet command to interact with SMTP and to collect list of valid users on the SMTP server.


# Next, use SMTP built-in-commands VRFY, EXPN, RCPT TO: 

- VRFY - Validates users 
- EXPN - Tells the actual delivery addresses of aliases and mailing lists 
- RCPT TO - Defines the recipients of the message

- SMTP servers respond differently to VRFY, EXPN, and RCPT TO commands for valid and invalid users from which we can determine valid users on SMTP server.

*IMPACT

- Attackers can directly interact with SMTP via the telnet prompt and collect of valid users on the SMTP server.



*Use the SMTP VRFY command

# telnet 192.168.168.1 25 
# VRFY admin


Use the SMTP EXPN Command 
# telnet 192.168.168.1 25
# EXPN admin

Use the SMTP RCPT TO Command
# RCPT TO:admin


Check nse scripts
----------------------
# ls -l /usr/share/nmap/scripts | grep smtp


NSE script
----------------
# nmap --script smtp-* -p 25 192.168.1.1


To interact SMTP 
-----------------------
# nc  192.168.1.6 25

# VRFY admin


*SMTP-USER-ENUM TOOL


# smtp-user-enum -M VRFY -U user.txt -t 192.168.1.6



*using msfconsole to identify


# search smtp

# use auxiliary(scanner/smtp/smtp_login)

# set RHOSTS 192.168.1.1

# run



