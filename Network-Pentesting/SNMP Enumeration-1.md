*SNMP Enumeration


# SNMP ROLES
- SNMP Manager
- SNMP Agent

# SNMP WORKING
- MIB Management Information Base

- OID Object Identifier

# VERSIONS OF SNMP

 - SNMPv1
Uses community string and its send in clear-text

 - SNMPv2c
Used community string and it send in clear text
GETBULK & GETNEXT messages

 - SNMPv3
Has more security features
noAutoNoPriv - Username authentication no encryption

authNoPriv - MD5 or SHA authentication no encryption

authPriv - MD5 or SHA authentication & Encryption


# SNMP MESSAGES
GET Message
- GET Request, mesaage from manager to agent
- GET Response, Reply to the get request
SET message
TRAP Message
INFORM message


*SNMP CONFIGURATION IN ROUTER


To Enable SNMP services with default community names

# set service snmp community public authorization ro
# set service snmp community private authorization rw

ENUMERATION
1. Enumeration using NMAP
2. Enumeration USing NMAP Scripts
3. Enumeration using SNMP-CHECK tool
4. Enumeration using MSF

1. Enumeration using NMAP
# nmap -sU -p 161 -sV 192.168.1.24
# nmap -sU 172.20.10.7
(It will take more time to show results)


2. Enumeration USing NMAP Scripts

- Using SNMP-INFO Script
# nmap -sU -p 161 --script=snmp-info 172.20.10.7

- Using SNMP-INTERFACES Script
# nmap -sU -p 161 --script=snmp-interfacees 172.20.10.7

- Using SNMP-NETSTAT Script
Network Statistics
Which ports are used for tasks
# nmap -sU -p 161 --script=snmp-netstat 172.20.10.7

- Using SNMP-SYSDESCR Script
# It gives SNMP Server type and OS from an SNMP Service

# nmap -sU -p 161 --script snmp-sysdescr 172.20.10.7

- Using SNMP-PROCESSES Script

# nmap -sU -p 161 --script=snmp-processes 172.20.10.7

- Usinf Default Scripts
# nmap -sU -p 161 -sV -sC 172.20.10.7

- bruteforce community strings
# nmap -sU -p 161 --script=snmp-brute 192.168.1.24



3. Enumeration using SNMP-CHECK tool

# snmp-check 172.20.10.7


4. Enumeration using MSF

SNMP_ENUM

# msfconsole --> to open msf
# use auxiliary/scanner/snmp/snmp_enum
# show options
# set RHOSTS 172.20.10.6
# run


# use auxiliary/scanner/snmp/snmp_login
# show options
# set RHOSTS 172.20.10.6
# run




