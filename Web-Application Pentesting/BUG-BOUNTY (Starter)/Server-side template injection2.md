Server-side template injection

Description
Template Injection can arise both through developer error, and through the intentional exposure of templates in an attempt to offer rich functionality, as commonly done by wikis, blogs, marketing applications, and content management systems. Intentional template injection is such a common use-case that many template engines offer a 'sandboxed' mode for this express purpose.

Vulnerable URL:-
https://www.example.com/signup


Steps to Reproduce:

Step 1: Navigate to https://www.example.com/signup and try to register

Step 2: Now, in the First Name field, enter the value {{7*7}}


Step 3: Fill in the rest of the values on the Register page and register your account.


Step 4: We have used the payload {{7*7}} here to verify that it is being evaluated at the backend


Step 5: Notice that  arrives with the Subject as Hey 49!
Welcome to MailerSend.

Step 6: The attacker can now further exploit this issue by injecting malicious payloads in the Name field and gathering sensitive information from the application. By using this any attacker can execute an XSS payload.


Impact
Template engines are widely used by web applications to present dynamic data via web pages and emails. Unsafely embedding user input in templates enables Server-Side Template Injection, which can be used to directly attack web servers' internals and often obtain Remote Code Execution (RCE), turning every vulnerable application into a potential pivot point.


Remediation
Templates should not be created from user-controlled input. User input should be passed to the template using template parameters.


